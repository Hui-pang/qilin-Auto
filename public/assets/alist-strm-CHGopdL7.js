import{_ as F,r as v,K as N,m as z,c as K,j as u,a as l,w as t,n as k,p as L,i as q,q as R,E as G,s as H,k as r,u as J,o as g,t as Q,v as A,x as W,y as X,h as m,z as Y,A as Z,C as ee,b as le,e as te,f as ae}from"./index-CWseees8.js";import{a as b}from"./index-D4aPKAAE.js";/* empty css              *//* empty css                 *//* empty css                *//* empty css               */const se={class:"automation-container"},oe={class:"title-container"},ne={class:"title-buttons"},re={class:"card-actions"},de={key:1,class:"card-message"},ie={class:"dialog-footer"},ue={class:"dialog-footer"},me={__name:"alist-strm",setup(pe){const E=J(),{isDark:x,toggleTheme:I}=L(),p=v(!1),c=v(!1),d=v({}),n=v({address:"",apiKey:""}),o=v({id:"",address:"",apiKey:""}),D=N(()=>Object.values(d.value)),T=async()=>{try{const a=await b.get("/api/alist-strm");d.value=a.data}catch(a){r.error("获取配置失败"),console.error("获取配置失败:",a)}},U=async()=>{if(!n.value.address||!n.value.apiKey){r.warning("请填写完整信息");return}try{const a=await b.post("/api/alist-strm",n.value);d.value[a.data.id]=a.data,p.value=!1,n.value.address="",n.value.apiKey="",r.success("创建成功")}catch(a){r.error("创建配置失败"),console.error("创建配置失败:",a)}},j=async()=>{const a=Object.keys(d.value)[0];try{await b.delete(`/api/alist-strm/${a}`),delete d.value[a],r.success("删除成功")}catch(e){r.error("删除失败"),console.error("删除失败:",e)}};z(()=>{T()});const S=()=>{localStorage.removeItem("token"),localStorage.removeItem("expiresAt"),E.push("/login")},B=()=>{if(Object.keys(d.value).length>0){r.warning("已存在配置，不能创建更多");return}p.value=!0},M=a=>{o.value={...a},c.value=!0},O=async()=>{if(!o.value.address||!o.value.apiKey){r.warning("请填写完整信息");return}try{const a=await b.put(`/api/alist-strm/${o.value.id}`,{address:o.value.address,apiKey:o.value.apiKey});d.value[o.value.id]=a.data,c.value=!1,r.success("更新成功")}catch(a){r.error("更新配置失败"),console.error("更新配置失败:",a)}};return(a,e)=>{const V=Q,i=q,P=R,f=Z,$=Y,h=G,_=ae,y=te,w=le,C=H;return g(),K("div",se,[u("div",oe,[e[8]||(e[8]=u("h1",{class:"section-title"},"Alist-strm设置",-1)),u("div",ne,[l(i,{type:"info",circle:"",onClick:k(I)},{default:t(()=>[l(V,null,{default:t(()=>[(g(),A(W(k(x)?"Sunny":"Moon")))]),_:1})]),_:1},8,["onClick"]),l(i,{type:"danger",circle:"",onClick:S},{default:t(()=>[l(V,null,{default:t(()=>[l(k(X))]),_:1})]),_:1})])]),l(P),e[17]||(e[17]=u("h2",{class:"subsection-title"},"设置参数",-1)),l(h,{class:"content-card"},{default:t(()=>[u("div",re,[l(i,{type:"primary",onClick:B},{default:t(()=>e[9]||(e[9]=[m("创建")])),_:1}),l(i,{type:"danger",disabled:Object.keys(d.value).length===0,onClick:j},{default:t(()=>e[10]||(e[10]=[m("删除")])),_:1},8,["disabled"])]),Object.keys(d.value).length>0?(g(),A($,{key:0,data:D.value,style:{width:"100%"}},{default:t(()=>[l(f,{prop:"createTime",label:"创建时间",width:"180"},{default:t(s=>[m(ee(new Date(s.row.createTime).toLocaleString()),1)]),_:1}),l(f,{prop:"address",label:"Alist-strm地址"}),l(f,{prop:"apiKey",label:"API Key"}),l(f,{label:"操作",width:"120"},{default:t(s=>[l(i,{size:"small",type:"success",onClick:ce=>M(s.row)},{default:t(()=>e[11]||(e[11]=[m(" 编辑 ")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])):(g(),K("div",de,e[12]||(e[12]=[u("span",{class:"message-text"},"暂无配置，请点击创建按钮添加",-1)])))]),_:1}),l(C,{modelValue:p.value,"onUpdate:modelValue":e[3]||(e[3]=s=>p.value=s),title:"创建Alist-strm配置",width:"30%","close-on-click-modal":!1},{footer:t(()=>[u("span",ie,[l(i,{onClick:e[2]||(e[2]=s=>p.value=!1)},{default:t(()=>e[13]||(e[13]=[m("取消")])),_:1}),l(i,{type:"primary",onClick:U},{default:t(()=>e[14]||(e[14]=[m("创建")])),_:1})])]),default:t(()=>[l(w,{model:n.value,"label-width":"120px"},{default:t(()=>[l(y,{label:"Alist-strm地址："},{default:t(()=>[l(_,{modelValue:n.value.address,"onUpdate:modelValue":e[0]||(e[0]=s=>n.value.address=s),placeholder:"请输入Alist-strm地址"},null,8,["modelValue"])]),_:1}),l(y,{label:"API Key："},{default:t(()=>[l(_,{modelValue:n.value.apiKey,"onUpdate:modelValue":e[1]||(e[1]=s=>n.value.apiKey=s),placeholder:"请输入API Key"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),l(C,{modelValue:c.value,"onUpdate:modelValue":e[7]||(e[7]=s=>c.value=s),title:"编辑Alist-strm配置",width:"30%","close-on-click-modal":!1},{footer:t(()=>[u("span",ue,[l(i,{onClick:e[6]||(e[6]=s=>c.value=!1)},{default:t(()=>e[15]||(e[15]=[m("取消")])),_:1}),l(i,{type:"primary",onClick:O},{default:t(()=>e[16]||(e[16]=[m("确定")])),_:1})])]),default:t(()=>[l(w,{model:o.value,"label-width":"120px"},{default:t(()=>[l(y,{label:"Alist-strm地址："},{default:t(()=>[l(_,{modelValue:o.value.address,"onUpdate:modelValue":e[4]||(e[4]=s=>o.value.address=s),placeholder:"请输入Alist-strm地址"},null,8,["modelValue"])]),_:1}),l(y,{label:"API Key："},{default:t(()=>[l(_,{modelValue:o.value.apiKey,"onUpdate:modelValue":e[5]||(e[5]=s=>o.value.apiKey=s),placeholder:"请输入API Key"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}},ke=F(me,[["__scopeId","data-v-c1db8019"]]);export{ke as default};
